<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const category = urlParams.get('category');

            const products = {
                chinese: [
                    { name: 'CHICKEN MANCHURIAN', price: 2 },
                    { name: 'CHICKEN CHILLY', price: 4 },
                    { name: 'EGG MANCHURIAN', price: 3 },
                    { name: 'CHICKEN CHILLY', price: 5 }
                ],
                falooda: [
                    { name: 'BOMBAY FALOODA', price: 4 },
                    { name: 'ROYAL FALOODA', price: 5 },
                    { name: 'KESAR FALOODA', price: 3 }
                ],
                signature_kunafa: [
                    { name: 'cream kunafa', price: 4 },
                    { name: 'cream cheese', price: 2 },
                    { name: 'mozzarella cheese', price: 5 },
                    { name: 'caramel pudding', price: 3 }
                ],
                dry_fruit_kunafa: [
                    { name: 'nuts kunafa', price: 4 },
                    { name: 'pista', price: 2 },
                    { name: 'almond', price: 1 },
                    { name: 'anjeer', price: 5 }
                ],
                chocolate_kunafa: [
                    { name: 'nutella kunafa', price: 4 },
                    { name: 'silk', price: 4 },
                    { name: 'lotus biscoff', price: 5 },
                    { name: 'nutella with dry fruits', price: 1 }
                ]
            };

            const productContainer = document.querySelector('.products-container');
            productContainer.innerHTML = '';

            if (products[category]) {
                products[category].forEach(product => {
                    const productElement = document.createElement('div');
                    productElement.classList.add('product-item');
                    productElement.setAttribute('data-product', product.name);
                    productElement.setAttribute('data-price', product.price);
                    productElement.innerHTML = `${product.name} - $${product.price} <button class="add-to-cart" data-product="${product.name}" data-price="${product.price}">Add to Cart</button>`;
                    productContainer.appendChild(productElement);

                    // Navigate to details page when product name is clicked
                    productElement.addEventListener('click', function (event) {
                        if (!event.target.classList.contains('add-to-cart')) {
                            window.location.href = `details.html?product=${product.name}&price=${product.price}`;
                        }
                    });
                });
            } else {
                productContainer.textContent = 'No products available for this category.';
            }

            const addToCartButtons = document.querySelectorAll('.add-to-cart');
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function (event) {
                    event.stopPropagation(); // Prevent the click event from bubbling up to the product item
                    const product = this.getAttribute('data-product');
                    const price = parseFloat(this.getAttribute('data-price'));
                    let cart = JSON.parse(localStorage.getItem('cart')) || [];

                    const existingItem = cart.find(item => item.product === product);
                    if (existingItem) {
                        cart = cart.filter(item => item.product !== product);
                        this.textContent = 'Add to Cart';
                    } else {
                        cart.push({ product, price, quantity: 1 });
                        this.textContent = 'Added';
                    }

                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartCount();
                });

                const product = button.getAttribute('data-product');
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                if (cart.find(item => item.product === product)) {
                    button.textContent = 'Added';
                }
            });

            function updateCartCount() {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                document.querySelector('.cart-count').textContent = cart.length;
            }

            updateCartCount();
        });
    </script>
</head>
<body>
    <div class="products-container">
        <!-- Product items will be injected here -->
    </div>
    <div class="cart-box" onclick="window.location.href='cart.html'">
        <span>Cart</span>
        <div class="cart-count">0</div>
    </div>
    <div class="home-box" onclick="window.location.href='index.html'">
        <span>Home</span>
    </div>
    
</body>
</html>
